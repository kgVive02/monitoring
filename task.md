# NBP/DR 실시간 전환 모니터링 대시보드 개발 계획

---

## 대상 시스템 환경

### 모니터링 대상 서버
- **NBP 서버**: 네이버 비즈니스 플랫폼 운영 서버군
  - 서비스별로 다수의 서버로 구성
  - L4/GLB를 통한 로드밸런싱 환경
  - SNMP 에이전트를 통한 세션/트래픽 정보 제공

- **DR 서버**: 재해복구(Disaster Recovery) 서버군  
  - NBP 서버와 동일한 구성의 백업 서버군
  - 평상시 대기 상태, 장애 시 트래픽 전환 대상
  - SNMP 에이전트를 통한 세션/트래픽 정보 제공

### 시스템 규모
- **서비스 수**: 최대 30개 서비스
- **서버 수**: 총 100대 규모 (NBP + DR 서버 합계)
- **모니터링 주기**: 3~10초 간격 실시간 폴링
- **데이터 보관**: 실시간(메모리) + 10분 이력(Ring Buffer) + 24시간 이력(로그) + 3개월 이력(집계파일)

### 네트워크 환경
- **모니터링 서버**: 내부망에서만 접근 가능
- **웹 대시보드**: 외부망에서도 접근 가능
- **SNMP 통신**: 내부망을 통한 서버 간 통신
- **보안**: SNMP Community 문자열 암호화 필요

---

## 개발 유의사항

### AI 개발툴 활용
- **개발(코딩)은 아래 2개의 AI 개발툴을 이용해서 진행하며 전체적인 검수 및 진행은 사람이 직접 체크한다.**

#### AI 개발툴 1: Codex
- OpenAI에서 제공하는 웹 클라우드 기반 소프트웨어 엔지니어링 에이전트
- https://chatgpt.com/codex 에 접속해서 사람이 AI에게 개발을 시킬 수 있음

#### AI 개발툴 2: Kiro IDE
- Amazon 사에서 제공하는 통합개발환경 프로그램
- Amazon 내에서 자체 AI 또는 Claude 같은 외부 AI를 연동해서 AI에게 개발을 시킬 수 있음

### 개발 진행 원칙
- **Codex와 Kiro를 같이 사용해서 개발하니까 2개의 AI 개발툴은 항상 최신 상태를 체크하고 개발을 진행해야 함**
- **Codex와 Kiro 둘이 이해할 수 있도록 개발 진행사항 이력을 항상 업데이트 해서 최신 상태를 유지해야 함**
- **각 Phase, Task 별로 완료 표시를 공유할 수 있는 체크리스트 형식으로 작성하고 작업 완료 시 완료 상태를 task.md 에 즉각 반영**
- **모든 가이드 및 답변은 한국어로 제공해야 함**
- **지시한 Phase, Task 만 진행하고 다음 단계는 지시가 있을 때 까지 대기**

---

## Phase 1: 프로젝트 초기 설정 및 구조 설계

### Task 1.1: 프로젝트 구조 설계
- [x] Spring Boot 프로젝트 기본 구조 설계
- [x] Maven/Gradle 의존성 정의
- [x] 패키지 구조 설계 (controller, service, config, model 등)
- [x] Java 1.7 호환성 확인 및 설정

### Task 1.2: 설정 파일 구조 설계
- [ ] system.properties 파일 구조 정의
- [ ] 서비스 설정 정보 모델 클래스 설계
- [ ] 설정 파일 변경 감지 메커니즘 설계

### Task 1.3: SNMP 연동 구조 설계
- [ ] SNMP 라이브러리 선택 및 의존성 추가
- [ ] SNMP 클라이언트 클래스 설계
- [ ] 오류 처리 및 재시도 로직 설계

---

## Phase 2: 백엔드 핵심 기능 개발

### Task 2.1: 설정 관리 모듈 개발
- [ ] system.properties 파일 로더 구현
- [ ] 설정 정보 메모리 캐시 구현
- [ ] 파일 변경 감지 및 리로드 기능 구현
- [ ] 설정 정보 검증 로직 구현

### Task 2.2: SNMP 모니터링 모듈 개발
- [ ] SNMP 클라이언트 구현
- [ ] 주기적 폴링 스케줄러 구현 (3~10초 주기)
- [ ] 세션 수/트래픽 지표 수집 로직 구현
- [ ] SNMP 오류 처리 및 직전 값 유지 로직 구현

### Task 2.3: 데이터 처리 및 캐시 모듈 개발
- [ ] 실시간 데이터 메모리 캐시 구현
- [ ] Ring Buffer 기반 최근 10분 이력 관리 구현
- [ ] 서비스별 NBP/DR 합계 계산 로직 구현
- [ ] 데이터 덮어쓰기 및 메모리 관리 구현

### Task 2.4: 로그 파일 관리 모듈 개발
- [ ] 날짜별 로그 파일 append 기능 구현
- [ ] 24시간 이력 조회를 위한 로그 파싱 구현
- [ ] 5분 단위 다운샘플링 로직 구현
- [ ] 로그 파일 압축 및 정리 기능 구현

### Task 2.5: 집계 배치 모듈 개발
- [ ] 일별 집계 배치 스케줄러 구현 (매일 00:05)
- [ ] 전일 로그 파일 5분 단위 집계 로직 구현
- [ ] 집계 결과 CSV 파일 생성 기능 구현
- [ ] 최대 3개월 이력 조회 로직 구현

---

## Phase 3: REST API 개발

### Task 3.1: 서비스 목록 API 개발
- [ ] `/api/services` GET API 구현
- [ ] 서비스명, 유형(L4/GLB) 반환 로직 구현
- [ ] 서버 구성 정보 반환 로직 구현
- [ ] 현재 NBP/DR 비율 계산 로직 구현
- [ ] 에러 상태 표시 로직 구현

### Task 3.2: 실시간 상세 조회 API 개발
- [ ] `/api/services/{id}/ratio` GET API 구현
- [ ] 현재 NBP/DR 값 및 비율 반환 구현
- [ ] 마지막 갱신 시간 반환 구현
- [ ] Ring Buffer 기반 10분 그래프 데이터 반환 구현

### Task 3.3: 이력 조회 API 개발
- [ ] `/api/services/{id}/history` GET API 구현
- [ ] hours 파라미터 처리 (24시간 이력) 구현
- [ ] days 파라미터 처리 (최대 90일 이력) 구현
- [ ] 로그 기반 데이터 필터링 및 정렬 구현
- [ ] 성능 최적화 (1-2초 내 응답) 구현

---

## Phase 4: 프론트엔드 개발

### Task 4.1: 반응형 웹 대시보드 기본 구조
- [ ] HTML5/CSS3/JavaScript 기반 반응형 레이아웃 구현
- [ ] 서비스 목록 표시 화면 구현
- [ ] 네비게이션 및 메뉴 구조 구현
- [ ] 모바일/태블릿/데스크톱 반응형 디자인 구현

### Task 4.2: 실시간 모니터링 화면 개발
- [ ] 서비스별 현재 상태 표시 위젯 구현
- [ ] NBP/DR 비율 시각화 (차트/게이지) 구현
- [ ] 실시간 데이터 자동 갱신 기능 구현
- [ ] 에러 상태 표시 (빨간색/노란색/회색) 구현

### Task 4.3: 그래프 및 차트 기능 개발
- [ ] 최근 10분 실시간 그래프 구현
- [ ] 24시간 이력 그래프 구현
- [ ] 최대 3개월 이력 그래프 구현
- [ ] 차트 라이브러리 연동 및 커스터마이징

### Task 4.4: 사용자 인터페이스 개선
- [ ] 직관적인 전환 상태 표시 구현
- [ ] 필터링 및 검색 기능 구현
- [ ] 데이터 내보내기 기능 구현
- [ ] 사용자 설정 저장 기능 구현

---

## Phase 5: 보안 및 성능 최적화

### Task 5.1: 보안 강화
- [ ] SNMP Community 문자열 암호화/마스킹 구현
- [ ] 웹 접근 보안 설정 구현
- [ ] 내부망 접근 제한 설정 구현
- [ ] 입력값 검증 및 SQL 인젝션 방지 구현

### Task 5.2: 성능 최적화
- [ ] 실시간 API 1초 미만 응답 최적화
- [ ] 서비스 30개/서버 100대 규모 처리 최적화
- [ ] 90일 이력 조회 1-2초 내 응답 최적화
- [ ] 메모리 사용량 최적화 및 모니터링

### Task 5.3: 안정성 강화
- [ ] 캐시 덮어쓰기 및 고정 길이 구조 안정성 검증
- [ ] 장기 이력 집계 파일 기반 조회 안정성 검증
- [ ] 예외 처리 및 로깅 체계 구현
- [ ] 시스템 모니터링 및 알림 기능 구현

---

## Phase 6: 테스트 및 배포

### Task 6.1: 단위 테스트 개발
- [ ] 설정 관리 모듈 단위 테스트 구현
- [ ] SNMP 모니터링 모듈 단위 테스트 구현
- [ ] 데이터 처리 모듈 단위 테스트 구현
- [ ] API 컨트롤러 단위 테스트 구현

### Task 6.2: 통합 테스트 개발
- [ ] 전체 시스템 통합 테스트 시나리오 작성
- [ ] 성능 테스트 시나리오 작성 및 실행
- [ ] 부하 테스트 (서비스 30개/서버 100대) 실행
- [ ] 장애 상황 테스트 및 복구 검증

### Task 6.3: 배포 및 운영 준비
- [ ] 배포 스크립트 및 가이드 작성
- [ ] 운영 매뉴얼 작성
- [ ] 모니터링 및 알림 설정 가이드 작성
- [ ] 백업 및 복구 절차 가이드 작성

---

## Phase 7: 문서화 및 가이드 작성

### Task 7.1: 기술 문서 작성
- [ ] 시스템 아키텍처 문서 작성
- [ ] API 명세서 작성
- [ ] 데이터베이스 스키마 문서 작성
- [ ] 설정 파일 가이드 작성

### Task 7.2: 사용자 가이드 작성
- [ ] 사용자 매뉴얼 작성
- [ ] 관리자 가이드 작성
- [ ] 트러블슈팅 가이드 작성
- [ ] FAQ 문서 작성

### Task 7.3: AI 가이드 문서 작성
- [ ] ai_guide.md 파일 작성 (AI 개발툴 간 협업 가이드)
- [ ] 개발 진행사항 추적 가이드 작성
- [ ] 코드 리뷰 및 품질 관리 가이드 작성
- [ ] 버전 관리 및 배포 가이드 작성

---

## 진행 상황 추적

### 현재 진행 단계
- **현재 Phase**: Phase 1 (프로젝트 초기 설정 및 구조 설계)
- **현재 Task**: Task 1.1 완료, Task 1.2 대기 중
- **마지막 업데이트**: 2024-12-22

### 완료된 작업
- [x] PRD 문서 분석 완료
- [x] 개발 계획 문서(task.md) 작성 완료
- [x] Task 1.1: 프로젝트 구조 설계 완료
  - Spring Boot 1.5.22 + Java 1.7 기반 프로젝트 구조 생성
  - Maven 의존성 정의 (SNMP4J, Spring Boot, Commons 등)
  - 패키지 구조 설계 및 기본 클래스 생성
  - 웹 대시보드 기본 구조 (HTML, CSS, JS) 생성
  - 설정 파일 및 테스트 구조 생성

### 다음 진행 예정 작업
- 지시가 있을 때까지 대기

---

## 참고사항
- 모든 개발 작업은 Codex와 Kiro IDE를 활용하여 진행
- 각 Task 완료 시 즉시 체크리스트 업데이트 필요
- 개발 진행사항은 두 AI 개발툴이 공유할 수 있도록 상세히 기록
- 한국어로 모든 문서 및 가이드 작성